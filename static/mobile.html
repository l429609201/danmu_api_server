<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Âæ°ÂùÇÂºπÂπï ¬∑ ÁßªÂä®Áâà</title>
  <link rel="icon" href="/static/logo.png" type="image/png" />
  <link rel="stylesheet" href="/static/css/mobile.css" />
</head>
<body>
  <div id="app">
    <!-- ÁôªÂΩïËßÜÂõæ -->
    <section id="auth-screen">
      <div class="theme-toggle-login">
        <button id="theme-toggle-login" class="text-btn" title="ÂàáÊç¢‰∏ªÈ¢ò">üé®</button>
      </div>
      <div class="auth-card">
        <div class="brand">
          <img src="/static/logo.png" alt="logo" />
          <h1>Âæ°ÂùÇÁΩëÁªúÂºπÂπï</h1>
        </div>
        <form id="login-form">
          <input id="login-username" type="text" placeholder="Áî®Êà∑Âêç" autocomplete="username" required />
          <input id="login-password" type="password" placeholder="ÂØÜÁ†Å" autocomplete="current-password" required />
          <button type="submit" class="primary">ÁôªÂΩï</button>
          <p id="auth-error" class="message error"></p>
        </form>
      </div>
    </section>

    <!-- ‰∏ªËßÜÂõæ -->
    <section id="main-screen" class="hidden">
      <header class="topbar">
        <div class="brand-mini">
          <img src="/static/logo.png" alt="logo" />
          <span>Âæ°ÂùÇÂºπÂπï ¬∑ ÁßªÂä®</span>
        </div>
        <div class="user">
          <button id="theme-toggle" class="text-btn" title="ÂàáÊç¢‰∏ªÈ¢ò">üåô</button>
          <span id="current-user-name">...</span>
          <button id="logout-btn" class="text-btn">ÈÄÄÂá∫</button>
        </div>
      </header>

      <main class="content" id="main-content">
        <section id="search-card" class="card search-sticky">
          <form id="search-form" class="search-bar">
            <input id="search-input" type="text" inputmode="search" placeholder="ËæìÂÖ•Áï™ÂâßÂêçÁß∞ÔºåÊîØÊåÅ SxxExx" required />
            <div class="search-btn-wrapper">
              <button type="submit" class="primary" id="search-btn">ÊêúÁ¥¢</button>
              <svg class="search-progress-ring" width="100" height="56" viewBox="0 0 100 56">
                <defs>
                  <linearGradient id="rainbow-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#ff6b6b" />
                    <stop offset="20%" style="stop-color:#4ecdc4" />
                    <stop offset="40%" style="stop-color:#45b7d1" />
                    <stop offset="60%" style="stop-color:#96ceb4" />
                    <stop offset="80%" style="stop-color:#ffeaa7" />
                    <stop offset="100%" style="stop-color:#ff6b6b" />
                  </linearGradient>
                </defs>
                <rect class="track" x="2" y="2" width="96" height="52" rx="26" ry="26" />
                <rect class="progress" x="2" y="2" width="96" height="52" rx="26" ry="26"
                      stroke="url(#rainbow-gradient)"
                      stroke-dasharray="296"
                      stroke-dashoffset="296" />
              </svg>
            </div>
          </form>
          <div id="loader" class="loader hidden"></div>
          <div id="search-progress" class="progress hidden"><div class="bar"></div><span id="search-progress-label" class="label">0%</span></div>
        </section>

        <section id="results-card" class="card">
          <h2>ÊêúÁ¥¢ÁªìÊûú</h2>
          <div id="results-skeleton" class="skeleton hidden"></div>
          <div id="results-empty" class="empty hidden">
            <div class="empty-illustration"></div>
            <p class="empty-title">ËøòÊ≤°ÊúâÁªìÊûú</p>
            <p class="empty-sub">ËØïËØïËæìÂÖ•ÂÆåÊï¥ÁâáÂêçÔºåÊàñÁî® SxxExx Á≤æÁ°ÆÂà∞ÈõÜÊï∞</p>
            <div class="empty-actions">
              <button id="btn-demo-search" class="row-action">Á§∫‰æãÊêúÁ¥¢</button>
            </div>
          </div>
          <ul id="results-list" class="list"></ul>
        </section>

        <section id="tasks-card" class="card hidden">
          <h2>‰ªªÂä°</h2>
          
          <!-- ‰ªªÂä°ÊÄªËøõÂ∫¶ÁéØÂΩ¢Â±ïÁ§∫ -->
          <div class="task-progress-container">
            <div class="task-progress-ring">
              <svg viewBox="0 0 120 120">
                <defs>
                  <linearGradient id="task-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" class="gradient-stop-1" />
                    <stop offset="50%" class="gradient-stop-2" />
                    <stop offset="100%" class="gradient-stop-3" />
                  </linearGradient>
                </defs>
                <circle class="track" cx="60" cy="60" r="52" />
                <circle class="progress" cx="60" cy="60" r="52" 
                        stroke="url(#task-gradient)"
                        stroke-dasharray="326.73"
                        stroke-dashoffset="326.73" />
              </svg>
              <div class="task-progress-center">
                <span class="task-progress-percentage">0%</span>
                <span class="task-progress-label">ÊÄªËøõÂ∫¶</span>
              </div>
            </div>
          </div>

          <!-- ‰ªªÂä°ÁªüËÆ°‰ø°ÊÅØ -->
          <div class="task-stats">
            <div class="task-stat-item running">
              <span class="task-stat-number" id="task-stat-running">0</span>
              <span class="task-stat-label">ËøêË°å‰∏≠</span>
            </div>
            <div class="task-stat-item queued">
              <span class="task-stat-number" id="task-stat-queued">0</span>
              <span class="task-stat-label">ÊéíÈòü‰∏≠</span>
            </div>
            <div class="task-stat-item completed">
              <span class="task-stat-number" id="task-stat-completed">0</span>
              <span class="task-stat-label">Â∑≤ÂÆåÊàê</span>
            </div>
            <div class="task-stat-item failed">
              <span class="task-stat-number" id="task-stat-failed">0</span>
              <span class="task-stat-label">Â§±Ë¥•</span>
            </div>
          </div>
          
          <!-- ‰ªªÂä°È°µÈù¢È™®Êû∂Â±è -->
          <div id="tasks-skeleton" class="skeleton-container">
            <div class="skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
              <div class="skeleton-actions">
                <div class="skeleton-button"></div>
              </div>
            </div>
            <div class="skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
              <div class="skeleton-actions">
                <div class="skeleton-button"></div>
              </div>
            </div>
            <div class="skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
              <div class="skeleton-actions">
                <div class="skeleton-button"></div>
              </div>
            </div>
          </div>
          
          <ul id="tasks-list" class="list"></ul>
        </section>

        <section id="library-card" class="card hidden">
          <div class="library-header">
            <h2>ÂºπÂπïÂ∫ì</h2>
            <button id="library-refresh-btn" class="text-btn" title="Âà∑Êñ∞ÂºπÂπïÂ∫ì">üîÑ</button>
          </div>
          
          <!-- Á≠õÈÄâËæìÂÖ•Ê°Ü -->
          <div class="library-filter">
            <input id="library-filter-input" type="text" placeholder="ËæìÂÖ•Âä®Êº´ÂêçÁß∞ËøõË°åÁ≠õÈÄâ..." />
          </div>
          
          <div id="library-loading" class="loading-indicator hidden">
            <div class="loading-spinner"></div>
            <span>Âä†ËΩΩ‰∏≠...</span>
          </div>

          <!-- ÂºπÂπïÂ∫ìÈ™®Êû∂Â±è -->
          <div id="library-skeleton" class="skeleton-container">
            <div class="skeleton-item library-skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
            </div>
            <div class="skeleton-actions-row">
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
            </div>
            
            <div class="skeleton-item library-skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
            </div>
            <div class="skeleton-actions-row">
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
            </div>
            
            <div class="skeleton-item library-skeleton-item">
              <div class="skeleton-avatar"></div>
              <div class="skeleton-content">
                <div class="skeleton-title"></div>
                <div class="skeleton-subtitle"></div>
              </div>
            </div>
            <div class="skeleton-actions-row">
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
              <div class="skeleton-button"></div>
            </div>
          </div>

          <ul id="library-list" class="list"></ul>
        </section>

        <section id="tokens-card" class="card hidden">
          <h2>Token ÁÆ°ÁêÜ</h2>
          <div class="section">
            <h3 class="small">Ëá™ÂÆö‰πâÂüüÂêç</h3>
            <div class="grid-2">
              <input id="token-custom-domain-input" placeholder="‰æãÂ¶Ç https://danmu.example.com" />
              <button id="token-save-domain-btn" class="row-action">‰øùÂ≠òÂüüÂêç</button>
            </div>
            <div id="token-domain-save-msg" class="message small"></div>
          </div>
          <div class="section">
            <h3 class="small">ÂÖ®Â±Ä User-Agent ËøáÊª§</h3>
            <div class="grid-2">
              <select id="token-ua-filter-mode">
                <option value="off">ÂÖ≥Èó≠</option>
                <option value="blacklist">ÈªëÂêçÂçï</option>
                <option value="whitelist">ÁôΩÂêçÂçï</option>
              </select>
              <div class="grid-2-no-gap">
                <button id="token-save-ua-mode-btn" class="row-action">‰øùÂ≠òÊ®°Âºè</button>
                <button id="token-manage-ua-list-btn" class="row-action">ÁÆ°ÁêÜÂêçÂçï</button>
              </div>
            </div>
            <div id="token-ua-mode-save-msg" class="message small"></div>
          </div>
          <div class="section">
            <h3 class="small">Êñ∞Â¢û Token</h3>
            <div class="grid-3">
              <input id="token-new-name" placeholder="ÂêçÁß∞" />
              <select id="token-validity">
                <option value="permanent" selected>Ê∞∏‰πÖ</option>
                <option value="1d">1 Â§©</option>
                <option value="7d">7 Â§©</option>
                <option value="30d">30 Â§©</option>
                <option value="180d">6 ‰∏™Êúà</option>
                <option value="365d">1 Âπ¥</option>
              </select>
              <button id="token-add-btn" class="row-action">Ê∑ªÂä†</button>
            </div>
          </div>
          <ul id="token-list" class="list"></ul>
        </section>

        <section id="tokens-ua-card" class="card hidden">
          <div class="grid-2">
            <button id="token-ua-back-btn" class="row-action">ËøîÂõû</button>
            <div></div>
          </div>
          <h2>ÁÆ°ÁêÜ UA ÂêçÂçï</h2>
          <div class="grid-2">
            <input id="token-ua-new" placeholder="Ê∑ªÂä† UA ÂÖ≥ÈîÆÂ≠ó" />
            <button id="token-ua-add-btn" class="row-action">Ê∑ªÂä†</button>
          </div>
          <ul id="token-ua-list" class="list"></ul>
        </section>

        <section id="tokens-log-card" class="card hidden">
          <div class="grid-2">
            <button id="token-log-back-btn" class="row-action">ËøîÂõû</button>
            <div></div>
          </div>
          <h2 id="token-log-title">Token ËÆøÈóÆÊó•Âøó</h2>
          <ul id="token-log-list" class="list"></ul>
        </section>

        <section id="settings-card" class="card hidden">
          <h2>ËÆæÁΩÆ</h2>
          <div class="subnav">
            <button id="mset-tab-account" class="subnav-btn">Ë¥¶Êà∑</button>
            <button id="mset-tab-webhook" class="subnav-btn">Webhook</button>
            <button id="mset-tab-bangumi" class="subnav-btn">Bangumi</button>
            <button id="mset-tab-tmdb" class="subnav-btn">TMDB</button>
            <button id="mset-tab-douban" class="subnav-btn">Ë±ÜÁì£</button>
            <button id="mset-tab-tvdb" class="subnav-btn">TVDB</button>
          </div>

          <div id="mset-account" class="settings-view hidden">
            <div class="section">
              <h3 class="small">‰øÆÊîπÂØÜÁ†Å</h3>
              <div class="grid-1">
                <input id="mset-old-password" type="password" placeholder="ÂΩìÂâçÂØÜÁ†Å" />
                <input id="mset-new-password" type="password" placeholder="Êñ∞ÂØÜÁ†ÅÔºàËá≥Â∞ë8‰ΩçÔºâ" />
                <input id="mset-confirm-password" type="password" placeholder="Á°ÆËÆ§Êñ∞ÂØÜÁ†Å" />
                <button id="mset-save-password-btn" class="row-action">Á°ÆËÆ§‰øÆÊîπ</button>
                <div id="mset-password-msg" class="message small"></div>
              </div>
            </div>
          </div>

          <div id="mset-webhook" class="settings-view hidden">
            <div class="section">
              <h3 class="small">API Key</h3>
              <div class="grid-2">
                <input id="mset-webhook-api-key" readonly />
                <button id="mset-regenerate-webhook-key" class="row-action">ÈáçÊñ∞ÁîüÊàê</button>
              </div>
            </div>
            <div class="section">
              <h3 class="small">Ëá™ÂÆö‰πâÂüüÂêç</h3>
              <div class="grid-2">
                <input id="mset-webhook-domain" placeholder="https://danmu.example.com" />
                <button id="mset-save-webhook-domain" class="row-action">‰øùÂ≠òÂüüÂêç</button>
              </div>
              <div id="mset-webhook-domain-msg" class="message small"></div>
            </div>
            <div class="section">
              <h3 class="small">URL ÁîüÊàê</h3>
              <div class="grid-1">
                <select id="mset-webhook-service"></select>
                <div class="grid-2">
                  <input id="mset-webhook-url" readonly placeholder="ÈÄâÊã©ÊúçÂä°ÂêéÁîüÊàê" />
                  <button id="mset-copy-webhook-url" class="row-action">Â§çÂà∂</button>
                </div>
              </div>
            </div>
          </div>

          <div id="mset-bangumi" class="settings-view hidden">
            <div class="section">
              <div class="grid-1">
                <input id="mset-bgm-client-id" placeholder="App ID" />
                <input id="mset-bgm-client-secret" type="password" placeholder="App Secret" />
                <button id="mset-save-bgm" class="row-action">‰øùÂ≠ò</button>
              </div>
            </div>
            <div class="section">
              <div class="grid-2">
                <button id="mset-bgm-login" class="row-action">ÁôªÂΩï</button>
                <button id="mset-bgm-logout" class="row-action hidden">Ê≥®ÈîÄ</button>
              </div>
              <div id="mset-bgm-state" class="small"></div>
            </div>
          </div>

          <div id="mset-tmdb" class="settings-view hidden">
            <div class="grid-1">
              <input id="mset-tmdb-key" type="password" placeholder="API Key (v3)" />
              <input id="mset-tmdb-api-base" placeholder="API ÂüüÂêç e.g. https://api.themoviedb.org" />
              <input id="mset-tmdb-img-base" placeholder="ÂõæÁâáÂüüÂêç e.g. https://image.tmdb.org/t/p/w500" />
              <button id="mset-save-tmdb" class="row-action">‰øùÂ≠ò</button>
              <div id="mset-tmdb-msg" class="message small"></div>
            </div>
          </div>

          <div id="mset-douban" class="settings-view hidden">
            <div class="grid-1">
              <textarea id="mset-douban-cookie" rows="4" placeholder="Ë±ÜÁì£ CookieÔºàÊèêÈ´òÊàêÂäüÁéáÔºåÈÄâÂ°´Ôºâ"></textarea>
              <button id="mset-save-douban" class="row-action">‰øùÂ≠ò</button>
              <div id="mset-douban-msg" class="message small"></div>
            </div>
          </div>

          <div id="mset-tvdb" class="settings-view hidden">
            <div class="grid-1">
              <input id="mset-tvdb-key" type="password" placeholder="TVDB API Key" />
              <button id="mset-save-tvdb" class="row-action">‰øùÂ≠ò</button>
              <div id="mset-tvdb-msg" class="message small"></div>
            </div>
          </div>
        </section>
      </main>

      <nav class="bottom-nav">
        <button id="tab-search" class="nav-btn active">ÊêúÁ¥¢</button>
        <button id="tab-library" class="nav-btn">Â∫ì</button>
        <button id="tab-tasks" class="nav-btn">‰ªªÂä°</button>
        <button id="tab-tokens" class="nav-btn">Token</button>
        <button id="tab-settings" class="nav-btn">ËÆæÁΩÆ</button>
      </nav>
    </section>
  </div>

  <script type="module" src="/static/js/mobile.js"></script>
</body>
</html>
